name: Update experience

on:
  workflow_dispatch:
  schedule:
    - cron: '30 0 1 * *'
  push:
    branches:
      - main
    paths:
      - .github/automations/experience.json
      - .github/automations/experience.js
      - .github/workflows/update-experience.yml

jobs:

  update-readme-with-blog:
    name: Update this repo's README with my experience
    runs-on: ubuntu-latest

    steps:

      - uses: actions/checkout@v4

      - uses: actions/setup-node@v3
        with:
          node-version: "16"
          cache: "yarn"

      - name: Run script
        run: |
          yarn install
          yarn start-experience

      - name: "Read/Write profiles' data"
        uses: guibranco/gh-actions-html-table-generator-fork@main
        with:
          json-file-path: ".github/automations/experience.json"
          github-token: ${{ secrets.GITHUB_TOKEN }}
          columns: 5
          file-to-use: "README.md"
          section-name: "experience-section"
          object-field-names: '[ "age", "tech" ]'
          html-cell: '<td><b>{{ age }}+</b> {{ tech }}</td>'